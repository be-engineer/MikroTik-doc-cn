# Summary

**Standards:** `RFC 1990`

Multi-Link Point to Point Protocol (MP, Multi-Link PPP, MultiPPP or MLPPP) is a method of splitting, recombining, and sequencing data across multiple logical data links.

In a situation where we have multiple DSL links a pair of devices, performance by “widening the pipe” between two devices can be increased by using Multi-Link PPP, without going to a newer, more expensive technology.

Large packets are actually split into bits and sent evenly over ALL logical data links. This is done instantaneously with NO loss of bandwidth. It is important to understand that other end of the link needs to use the same protocol to recombine your data.

Multilink is based on an [LCP](https://wiki.mikrotik.com/index.php?title=LCP&action=edit&redlink=1 "LCP (page does not exist)") option negotiation that allows to indicate to its peer that it is capable of combining multiple physical links.

# MLPPP over single link

Typically size of the packet sent over PPP link is reduced due to overhead. MP can be used to transmit and receive full frame over single ppp link. To make it work the Multilink Protocol uses additional LCP configuration options **Multilink Maximum Received Reconstructed Unit (MRRU)**

To enable Multi-link PPP over single link you must specify MRRU (Maximum Receive Reconstructed Unit) option. If both sides support this feature there are no need for MSS adjustment (in firewall mangle). Study shows that MRRU is less CPU expensive that 2 mangle rules per client. MRRU allows to divide packet to multiple channels therefore increasing possible MTU and MRU (up to 65535 bytes)

Under Windows it can be enabled in Networking tag, Settings button, "Negotiate multi-link for single link connections". Their MRRU is hard coded to 1614.

MTU will be reduced by 4 bytes to work properly when MPPE encryption is enabled

## Configuration Example

Let's configure pppoe server compatible with Windows clients and MRRU enabled.

[?](https://help.mikrotik.com/docs/display/ROS/MLPPP+over+single+and+multiple+links#)

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2" data-bidi-marker="true"><code class="ros plain">[admin@RB800] </code><code class="ros constants">/interface pppoe-server server&gt; </code><code class="ros functions">add </code><code class="ros value">service-name</code><code class="ros plain">=myPPP</code> <code class="ros value">interface</code><code class="ros plain">=ether1</code> <code class="ros value">mrru</code><code class="ros plain">=1614</code></div><div class="line number2 index1 alt1" data-bidi-marker="true"><code class="ros plain">[admin@RB800] </code><code class="ros constants">/interface pppoe-server server&gt; </code><code class="ros functions">print</code></div><div class="line number3 index2 alt2" data-bidi-marker="true"><code class="ros plain">Flags</code><code class="ros constants">: X - disab</code><code class="ros plain">led</code></div><div class="line number4 index3 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;</code><code class="ros plain">0&nbsp;&nbsp; </code><code class="ros value">service-name</code><code class="ros plain">=</code><code class="ros string">"myPPP"</code> <code class="ros value">interface</code><code class="ros plain">=ether1</code> <code class="ros value">max-mtu</code><code class="ros plain">=1480</code> <code class="ros value">max-mru</code><code class="ros plain">=1480</code> <code class="ros value">mrru</code><code class="ros plain">=1614</code></div><div class="line number5 index4 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros value">authentication</code><code class="ros plain">=pap,chap,mschap1,mschap2</code> <code class="ros value">keepalive-timeout</code><code class="ros plain">=10</code> <code class="ros value">one-session-per-host</code><code class="ros plain">=no</code></div><div class="line number6 index5 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros value">max-sessions</code><code class="ros plain">=0</code> <code class="ros value">default-profile</code><code class="ros plain">=default</code></div></div></td></tr></tbody></table>

In short - standard PPP link - just specify MRRU in both sides.

# MLPPP over multiple links

MLPPP over multiple links allow to create a single PPP link over multiple physical connections. All PPP links must come from the same server (server must have MLPPP over multiple links support) and all PPP links must have same user name and password.

And to enable MLPPP you just need to create PPP client and specify multiple interfaces instead of single interface. RouterOS has MLPPP client support only. Presently there are no MLPPP server support available.

## Configuration Example

![](https://help.mikrotik.com/docs/download/attachments/132350045/Mlppp.jpg?version=1&modificationDate=1657264990603&api=v2)

ISP gives to its client two physical links (DSL lines) 1Mbps each. To get aggregated 2Mbps pipe we have to set up MLPPP. Consider ISP router is pre-configured to support MLPPP.

Configuration on router (R1) is:

[?](https://help.mikrotik.com/docs/display/ROS/MLPPP+over+single+and+multiple+links#)

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2" data-bidi-marker="true"><code class="ros constants">/interface pppoe-client</code></div><div class="line number2 index1 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;</code><code class="ros functions">add </code><code class="ros value">service-name</code><code class="ros plain">=ISP</code> <code class="ros value">interface</code><code class="ros plain">=ether1,ether2</code> <code class="ros value">user</code><code class="ros plain">=xxx</code> <code class="ros value">password</code><code class="ros plain">=yyy</code> <code class="ros value">disabled</code><code class="ros plain">=no</code> <code class="ros plain">\</code></div><div class="line number3 index2 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;</code><code class="ros value">add-default-route</code><code class="ros plain">=yes</code> <code class="ros value">use-peer-dns</code><code class="ros plain">=yes</code></div></div></td></tr></tbody></table>

[?](https://help.mikrotik.com/docs/display/ROS/MLPPP+over+single+and+multiple+links#)

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2" data-bidi-marker="true"><code class="ros plain">[admin@RB800] </code><code class="ros constants">/interface pppoe-client&gt; </code><code class="ros functions">print</code></div><div class="line number2 index1 alt1" data-bidi-marker="true"><code class="ros plain">Flags</code><code class="ros constants">: X - disabled, R - running</code></div><div class="line number3 index2 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;</code><code class="ros plain">0&nbsp;&nbsp;&nbsp; </code><code class="ros value">name</code><code class="ros plain">=</code><code class="ros string">"pppoe-out1"</code> <code class="ros value">max-mtu</code><code class="ros plain">=1480</code> <code class="ros value">max-mru</code><code class="ros plain">=1480</code> <code class="ros value">mrru</code><code class="ros plain">=disabled</code> <code class="ros value">interface</code><code class="ros plain">=ether1,ether2</code></div><div class="line number4 index3 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros value">user</code><code class="ros plain">=</code><code class="ros string">"xxx"</code> <code class="ros value">password</code><code class="ros plain">=</code><code class="ros string">"yyy"</code> <code class="ros value">profile</code><code class="ros plain">=default</code> <code class="ros value">service-name</code><code class="ros plain">=</code><code class="ros string">"ISP"</code> <code class="ros value">ac-name</code><code class="ros plain">=</code><code class="ros string">""</code> <code class="ros value">add-default-route</code><code class="ros plain">=yes</code></div><div class="line number5 index4 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros value">dial-on-demand</code><code class="ros plain">=no</code> <code class="ros value">use-peer-dns</code><code class="ros plain">=yes</code> <code class="ros value">allow</code><code class="ros plain">=pap,chap,mschap1,mschap2</code></div></div></td></tr></tbody></table>

Now when PPPoE client is connected we can set up rest of configuration, local network address, enable DNS requests, set up masquerade and firewall

[?](https://help.mikrotik.com/docs/display/ROS/MLPPP+over+single+and+multiple+links#)

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2" data-bidi-marker="true"><code class="ros constants">/ip address </code><code class="ros functions">add </code><code class="ros value">address</code><code class="ros plain">=192.168.88.1/24</code> <code class="ros value">interface</code><code class="ros plain">=local</code></div><div class="line number2 index1 alt1" data-bidi-marker="true">&nbsp;</div><div class="line number3 index2 alt2" data-bidi-marker="true"><code class="ros constants">/ip dns </code><code class="ros functions">set </code><code class="ros value">allow-remote-request</code><code class="ros plain">=yes</code></div><div class="line number4 index3 alt1" data-bidi-marker="true">&nbsp;</div><div class="line number5 index4 alt2" data-bidi-marker="true"><code class="ros constants">/ip firewall nat</code></div><div class="line number6 index5 alt1" data-bidi-marker="true"><code class="ros functions">add </code><code class="ros value">chain</code><code class="ros plain">=src-nat</code> <code class="ros value">action</code><code class="ros plain">=masquerade</code> <code class="ros value">out-interface</code><code class="ros plain">=pppoe-out1</code></div><div class="line number7 index6 alt2" data-bidi-marker="true">&nbsp;</div><div class="line number8 index7 alt1" data-bidi-marker="true"><code class="ros constants">/ip firewall filter</code></div><div class="line number9 index8 alt2" data-bidi-marker="true"><code class="ros functions">add </code><code class="ros value">chain</code><code class="ros plain">=input</code> <code class="ros value">connection-state</code><code class="ros plain">=invalid</code> <code class="ros value">action</code><code class="ros plain">=drop</code> <code class="ros plain">\</code></div><div class="line number10 index9 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros value">comment</code><code class="ros plain">=</code><code class="ros string">"Drop Invalid connections"</code>&nbsp;</div><div class="line number11 index10 alt2" data-bidi-marker="true"><code class="ros functions">add </code><code class="ros value">chain</code><code class="ros plain">=input</code> <code class="ros value">connection-state</code><code class="ros plain">=established</code> <code class="ros value">action</code><code class="ros plain">=accept</code> <code class="ros plain">\</code></div><div class="line number12 index11 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros value">comment</code><code class="ros plain">=</code><code class="ros string">"Allow Established connections"</code>&nbsp;</div><div class="line number13 index12 alt2" data-bidi-marker="true"><code class="ros functions">add </code><code class="ros value">chain</code><code class="ros plain">=input</code> <code class="ros value">protocol</code><code class="ros plain">=icmp</code> <code class="ros value">action</code><code class="ros plain">=accept</code> <code class="ros plain">\</code></div><div class="line number14 index13 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros value">comment</code><code class="ros plain">=</code><code class="ros string">"Allow ICMP"</code></div><div class="line number15 index14 alt2" data-bidi-marker="true"><code class="ros functions">add </code><code class="ros value">chain</code><code class="ros plain">=input</code> <code class="ros value">src-address</code><code class="ros plain">=192.168.88.0/24</code> <code class="ros value">action</code><code class="ros plain">=accept</code> <code class="ros plain">\</code></div><div class="line number16 index15 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros value">in-interface</code><code class="ros plain">=!pppoe-out1</code></div><div class="line number17 index16 alt2" data-bidi-marker="true"><code class="ros functions">add </code><code class="ros value">chain</code><code class="ros plain">=input</code> <code class="ros value">action</code><code class="ros plain">=drop</code> <code class="ros value">comment</code><code class="ros plain">=</code><code class="ros string">"Drop everything else"</code></div></div></td></tr></tbody></table>

For more advanced router and customer protection check [firewall examples](https://help.mikrotik.com/docs/display/ROS/Filter).