# Introduction

This section contains some useful scripts and shows all available scripting features. Script examples used in this section were tested with the latest 3.x version.

# Create a file

it is not possible to create a file directly, however, there is a workaround:

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2" data-bidi-marker="true"><code class="ros constants">/</code><code class="ros functions">file </code><code class="ros functions">print </code><code class="ros value">file</code><code class="ros plain">=myFile</code></div><div class="line number2 index1 alt1" data-bidi-marker="true"><code class="ros constants">/</code><code class="ros functions">file </code><code class="ros functions">set </code><code class="ros plain">myFile.txt </code><code class="ros value">contents</code><code class="ros plain">=</code><code class="ros string">""</code></div></div></td></tr></tbody></table>

# Check if IP on the interface has changed

Sometimes provider gives dynamic IP addresses. This script will compare if a dynamic IP address is changed.

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">currentIP;</code></div><div class="line number2 index1 alt1" data-bidi-marker="true">&nbsp;</div><div class="line number3 index2 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">local </code><code class="ros plain">newIP [</code><code class="ros constants">/ip address </code><code class="ros functions">get </code><code class="ros plain">[</code><code class="ros functions">find </code><code class="ros value">interface</code><code class="ros plain">=</code><code class="ros string">"ether1"</code><code class="ros plain">] address];</code></div><div class="line number4 index3 alt1" data-bidi-marker="true">&nbsp;</div><div class="line number5 index4 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">if </code><code class="ros plain">(</code><code class="ros keyword">$newIP</code>&nbsp;<code class="ros plain">!</code><code class="ros plain">=</code> <code class="ros keyword">$currentIP</code><code class="ros plain">) </code><code class="ros value">do</code><code class="ros plain">=</code><code class="ros plain">{</code></div><div class="line number6 index5 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">put </code><code class="ros string">"ip address $currentIP changed to $newIP"</code><code class="ros plain">;</code></div><div class="line number7 index6 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">set </code><code class="ros plain">currentIP </code><code class="ros keyword">$newIP</code><code class="ros plain">;</code></div><div class="line number8 index7 alt1" data-bidi-marker="true"><code class="ros plain">}</code></div></div></td></tr></tbody></table>

  

# Strip netmask

This script is useful if you need an IP address without a netmask (for example to use it in a firewall), but "`/ip address get [id] address`" returns the IP address and netmask.

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">ipaddress </code><code class="ros color1">10.1.101.1/24</code></div><div class="line number2 index1 alt1" data-bidi-marker="true">&nbsp;</div><div class="line number3 index2 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">for </code><code class="ros plain">i </code><code class="ros value">from</code><code class="ros plain">=(</code> <code class="ros plain">[</code><code class="ros constants">:</code><code class="ros functions">len </code><code class="ros keyword">$ipaddress</code><code class="ros plain">] - 1) </code><code class="ros value">to</code><code class="ros plain">=0</code> <code class="ros value">do</code><code class="ros plain">=</code><code class="ros plain">{</code></div><div class="line number4 index3 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">if </code><code class="ros plain">( [</code><code class="ros constants">:</code><code class="ros functions">pick </code><code class="ros keyword">$ipaddress</code> <code class="ros keyword">$i</code><code class="ros plain">] </code><code class="ros plain">=</code> <code class="ros string">"/"</code><code class="ros plain">) </code><code class="ros value">do</code><code class="ros plain">=</code><code class="ros plain">{</code></div><div class="line number5 index4 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">put </code><code class="ros plain">[</code><code class="ros constants">:</code><code class="ros functions">pick </code><code class="ros keyword">$ipaddress</code> <code class="ros plain">0 </code><code class="ros keyword">$i</code><code class="ros plain">]</code></div><div class="line number6 index5 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros plain">}</code></div><div class="line number7 index6 alt2" data-bidi-marker="true"><code class="ros plain">}</code></div></div></td></tr></tbody></table>

  

  
Another much more simple way:

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">ipaddress </code><code class="ros color1">10.1.101.1/24</code></div><div class="line number2 index1 alt1" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">put </code><code class="ros plain">[</code><code class="ros constants">:</code><code class="ros functions">pick </code><code class="ros keyword">$ipaddress</code> <code class="ros plain">0 [</code><code class="ros constants">:</code><code class="ros functions">find </code><code class="ros keyword">$ipaddress</code> <code class="ros string">"/"</code><code class="ros plain">]]</code></div></div></td></tr></tbody></table>

# Resolve host-name

Many users are asking features to use DNS names instead of IP addresses for radius servers, firewall rules, etc.

So here is an example of how to resolve the RADIUS server's IP.

Let's say we have the radius server configured:

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2" data-bidi-marker="true"><code class="ros constants">/radius</code></div><div class="line number2 index1 alt1" data-bidi-marker="true"><code class="ros functions">add </code><code class="ros value">address</code><code class="ros plain">=3.4.5.6</code> <code class="ros value">comment</code><code class="ros plain">=myRad</code></div></div></td></tr></tbody></table>

  

And here is a script that will resolve the IP address, compare resolved IP with configured one, and replace it if not equal:

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2" data-bidi-marker="true"><code class="ros constants">/system script </code><code class="ros functions">add </code><code class="ros value">name</code><code class="ros plain">=</code><code class="ros string">"resolver"</code> <code class="ros value">source</code><code class="ros plain">=</code> <code class="ros plain">{</code></div><div class="line number2 index1 alt1" data-bidi-marker="true">&nbsp;</div><div class="line number3 index2 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">local </code><code class="ros plain">resolvedIP [</code><code class="ros constants">:</code><code class="ros functions">resolve </code><code class="ros string">"server.example.com"</code><code class="ros plain">];</code></div><div class="line number4 index3 alt1" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">local </code><code class="ros plain">radiusID [</code><code class="ros constants">/radius </code><code class="ros functions">find </code><code class="ros value">comment</code><code class="ros plain">=</code><code class="ros string">"myRad"</code><code class="ros plain">];</code></div><div class="line number5 index4 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">local </code><code class="ros plain">currentIP [</code><code class="ros constants">/radius </code><code class="ros functions">get </code><code class="ros keyword">$radiusID</code> <code class="ros plain">address];</code></div><div class="line number6 index5 alt1" data-bidi-marker="true">&nbsp;</div><div class="line number7 index6 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">if </code><code class="ros plain">(</code><code class="ros keyword">$resolvedIP</code>&nbsp;<code class="ros plain">!</code><code class="ros plain">=</code> <code class="ros keyword">$currentIP</code><code class="ros plain">) </code><code class="ros value">do</code><code class="ros plain">=</code><code class="ros plain">{</code></div><div class="line number8 index7 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;</code><code class="ros constants">/radius </code><code class="ros functions">set </code><code class="ros keyword">$radiusID</code> <code class="ros value">address</code><code class="ros plain">=$resolvedIP</code><code class="ros plain">;</code></div><div class="line number9 index8 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;</code><code class="ros constants">/</code><code class="ros functions">log </code><code class="ros functions">info </code><code class="ros string">"radius ip updated"</code><code class="ros plain">;</code></div><div class="line number10 index9 alt1" data-bidi-marker="true"><code class="ros plain">}</code></div><div class="line number11 index10 alt2" data-bidi-marker="true">&nbsp;</div><div class="line number12 index11 alt1" data-bidi-marker="true"><code class="ros plain">}</code></div></div></td></tr></tbody></table>

  

Add this script to the scheduler to run for example every 5 minutes

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2" data-bidi-marker="true"><code class="ros constants">/system scheduler </code><code class="ros functions">add </code><code class="ros value">name</code><code class="ros plain">=resolveRadiusIP</code> <code class="ros value">on-event</code><code class="ros plain">=</code><code class="ros string">"resolver"</code> <code class="ros value">interval</code><code class="ros plain">=5m</code></div></div></td></tr></tbody></table>

  

# Write simple queue stats in multiple files

Let's consider queue namings are "some text.1" so we can search queues by the last number right after the dot.

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">local </code><code class="ros plain">entriesPerFile 10;</code></div><div class="line number2 index1 alt1" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">local </code><code class="ros plain">currentQueue 0;</code></div><div class="line number3 index2 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">local </code><code class="ros plain">queuesInFile 0;</code></div><div class="line number4 index3 alt1" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">local </code><code class="ros plain">fileContent </code><code class="ros string">""</code><code class="ros plain">;</code></div><div class="line number5 index4 alt2" data-bidi-marker="true"><code class="ros comments">#determine needed file count</code></div><div class="line number6 index5 alt1" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">local </code><code class="ros plain">numQueues [</code><code class="ros constants">/queue simple </code><code class="ros functions">print </code><code class="ros plain">count-only]&nbsp;;</code></div><div class="line number7 index6 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">local </code><code class="ros plain">fileCount (</code><code class="ros keyword">$numQueues</code> <code class="ros constants">/ $entriesPerFile);</code></div><div class="line number8 index7 alt1" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">if </code><code class="ros plain">( (</code><code class="ros keyword">$fileCount</code> <code class="ros plain">* </code><code class="ros keyword">$entriesPerFile</code><code class="ros plain">)&nbsp;!</code><code class="ros plain">=</code> <code class="ros keyword">$numQueues</code><code class="ros plain">) </code><code class="ros value">do</code><code class="ros plain">=</code><code class="ros plain">{</code></div><div class="line number9 index8 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">set </code><code class="ros plain">fileCount (</code><code class="ros keyword">$fileCount</code> <code class="ros plain">+ 1);</code></div><div class="line number10 index9 alt1" data-bidi-marker="true"><code class="ros plain">}</code></div><div class="line number11 index10 alt2" data-bidi-marker="true">&nbsp;</div><div class="line number12 index11 alt1" data-bidi-marker="true"><code class="ros comments">#remove old files</code></div><div class="line number13 index12 alt2" data-bidi-marker="true"><code class="ros constants">/</code><code class="ros functions">file </code><code class="ros functions">remove </code><code class="ros plain">[</code><code class="ros functions">find </code><code class="ros plain">name~</code><code class="ros string">"stats"</code><code class="ros plain">];</code></div><div class="line number14 index13 alt1" data-bidi-marker="true">&nbsp;</div><div class="line number15 index14 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">put </code><code class="ros string">"fileCount=$fileCount"</code><code class="ros plain">;</code></div><div class="line number16 index15 alt1" data-bidi-marker="true">&nbsp;</div><div class="line number17 index16 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">for </code><code class="ros plain">i </code><code class="ros value">from</code><code class="ros plain">=1</code> <code class="ros value">to</code><code class="ros plain">=$fileCount</code> <code class="ros value">do</code><code class="ros plain">=</code><code class="ros plain">{</code></div><div class="line number18 index17 alt1" data-bidi-marker="true"><code class="ros comments">#create file</code></div><div class="line number19 index18 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;</code><code class="ros constants">/</code><code class="ros functions">file </code><code class="ros functions">print </code><code class="ros value">file</code><code class="ros plain">=</code><code class="ros string">"stats$i.txt"</code><code class="ros plain">;</code></div><div class="line number20 index19 alt1" data-bidi-marker="true"><code class="ros comments">#clear content</code></div><div class="line number21 index20 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;</code><code class="ros constants">/</code><code class="ros functions">file </code><code class="ros functions">set </code><code class="ros plain">[</code><code class="ros functions">find </code><code class="ros value">name</code><code class="ros plain">=</code><code class="ros string">"stats$i.txt"</code><code class="ros plain">] </code><code class="ros value">contents</code><code class="ros plain">=</code><code class="ros string">""</code><code class="ros plain">;</code></div><div class="line number22 index21 alt1" data-bidi-marker="true">&nbsp;</div><div class="line number23 index22 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">while </code><code class="ros plain">(</code><code class="ros keyword">$queuesInFile</code> <code class="ros plain">&lt; </code><code class="ros keyword">$entriesPerFile</code><code class="ros plain">) </code><code class="ros value">do</code><code class="ros plain">=</code><code class="ros plain">{</code></div><div class="line number24 index23 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">if </code><code class="ros plain">(</code><code class="ros keyword">$currentQueue</code> <code class="ros plain">&lt; </code><code class="ros keyword">$numQueues</code><code class="ros plain">) </code><code class="ros value">do</code><code class="ros plain">=</code><code class="ros plain">{</code></div><div class="line number25 index24 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">set </code><code class="ros plain">currentQueue (</code><code class="ros keyword">$currentQueue</code> <code class="ros plain">+1);</code></div><div class="line number26 index25 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">put </code><code class="ros keyword">$currentQueue</code>&nbsp;<code class="ros plain">;</code></div><div class="line number27 index26 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">/queue simple</code></div><div class="line number28 index27 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">local </code><code class="ros plain">internalID [</code><code class="ros functions">find </code><code class="ros plain">name~</code><code class="ros string">"\\.$currentQueue\$"</code><code class="ros plain">];</code></div><div class="line number29 index28 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">put </code><code class="ros string">"internalID=$internalID"</code><code class="ros plain">;</code></div><div class="line number30 index29 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">set </code><code class="ros plain">fileContent (</code><code class="ros keyword">$fileContent</code> <code class="ros plain">. [</code><code class="ros functions">get </code><code class="ros keyword">$internalID</code> <code class="ros plain">target-address] . \</code></div><div class="line number31 index30 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros string">" "</code> <code class="ros plain">. [</code><code class="ros functions">get </code><code class="ros keyword">$internalID</code> <code class="ros plain">total-bytes] . </code><code class="ros string">"\r\n"</code><code class="ros plain">);</code></div><div class="line number32 index31 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros plain">}</code></div><div class="line number33 index32 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">set </code><code class="ros plain">queuesInFile (</code><code class="ros keyword">$queuesInFile</code> <code class="ros plain">+1);</code></div><div class="line number34 index33 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number35 index34 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;</code><code class="ros plain">}</code></div><div class="line number36 index35 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;</code><code class="ros constants">/</code><code class="ros functions">file </code><code class="ros functions">set </code><code class="ros string">"stats$i.txt"</code> <code class="ros value">contents</code><code class="ros plain">=$fileContent</code><code class="ros plain">;</code></div><div class="line number37 index36 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">set </code><code class="ros plain">fileContent </code><code class="ros string">""</code><code class="ros plain">;</code></div><div class="line number38 index37 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">set </code><code class="ros plain">queuesInFile 0;</code></div><div class="line number39 index38 alt2" data-bidi-marker="true">&nbsp;</div><div class="line number40 index39 alt1" data-bidi-marker="true"><code class="ros plain">}</code></div></div></td></tr></tbody></table>

  

# Generate backup and send it by e-mail

This script generates a backup file and sends it to a specified e-mail address. The mail subject contains the router's name, current date, and time.

Note that the SMTP server must be configured before this script can be used. See [/tool e-mail](https://help.mikrotik.com/docs/display/ROS/E-mail) for configuration options.

  

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2" data-bidi-marker="true"><code class="ros constants">/system backup save name=email_backup</code></div><div class="line number2 index1 alt1" data-bidi-marker="true"><code class="ros constants">/tool e-mail </code><code class="ros functions">send </code><code class="ros value">file</code><code class="ros plain">=email_backup.backup</code> <code class="ros value">to</code><code class="ros plain">=</code><code class="ros string">"me@test.com"</code> <code class="ros value">body</code><code class="ros plain">=</code><code class="ros string">"See attached file"</code> <code class="ros plain">\</code></div><div class="line number3 index2 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;</code><code class="ros value">subject</code><code class="ros plain">=</code><code class="ros string">"$[/system identity get name] $[/system clock get time] $[/system clock get date] Backup"</code><code class="ros plain">)</code></div></div></td></tr></tbody></table>

  

  

The backup file contains sensitive information like passwords. So to get access to generated backup files, the script or scheduler must have a 'sensitive' policy.

Use string as a function

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">printA [</code><code class="ros constants">:</code><code class="ros functions">parse </code><code class="ros string">":local A; :put \$A;"</code> <code class="ros plain">];&nbsp;&nbsp;</code></div><div class="line number2 index1 alt1" data-bidi-marker="true"><code class="ros keyword">$printA</code></div></div></td></tr></tbody></table>

  

# Check bandwidth and add limitations

This script checks if the download on an interface is more than 512kbps if true then the queue is added to limit the speed to 256kbps.

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">foreach </code><code class="ros plain">i </code><code class="ros value">in</code><code class="ros plain">=[/interface</code> <code class="ros plain">find] </code><code class="ros value">do</code><code class="ros plain">=</code><code class="ros plain">{</code></div><div class="line number2 index1 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">/interface monitor-traffic $i once do={</code></div><div class="line number3 index2 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">if </code><code class="ros plain">($</code><code class="ros string">"received-bits-per-second"</code> <code class="ros plain">&gt; 0 ) </code><code class="ros value">do</code><code class="ros plain">=</code><code class="ros plain">{</code></div><div class="line number4 index3 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">local </code><code class="ros plain">tmpIP [</code><code class="ros constants">/ip address </code><code class="ros functions">get </code><code class="ros plain">[</code><code class="ros constants">/ip address </code><code class="ros functions">find </code><code class="ros value">interface</code><code class="ros plain">=$i]</code> <code class="ros plain">address]&nbsp;;</code></div><div class="line number5 index4 alt2" data-bidi-marker="true"><code class="ros comments">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :log warning $tmpIP&nbsp;;</code></div><div class="line number6 index5 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">for </code><code class="ros plain">j </code><code class="ros value">from</code><code class="ros plain">=(</code> <code class="ros plain">[</code><code class="ros constants">:</code><code class="ros functions">len </code><code class="ros keyword">$tmpIP</code><code class="ros plain">] - 1) </code><code class="ros value">to</code><code class="ros plain">=0</code> <code class="ros value">do</code><code class="ros plain">=</code><code class="ros plain">{</code></div><div class="line number7 index6 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">if </code><code class="ros plain">( [</code><code class="ros constants">:</code><code class="ros functions">pick </code><code class="ros keyword">$tmpIP</code> <code class="ros keyword">$j</code><code class="ros plain">] </code><code class="ros plain">=</code> <code class="ros string">"/"</code><code class="ros plain">) </code><code class="ros value">do</code><code class="ros plain">=</code><code class="ros plain">{</code></div><div class="line number8 index7 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">/queue simple </code><code class="ros functions">add </code><code class="ros value">name</code><code class="ros plain">=$i</code> <code class="ros value">max-limit</code><code class="ros plain">=256000/256000</code> <code class="ros value">dst-address</code><code class="ros plain">=[:pick</code> <code class="ros keyword">$tmpIP</code> <code class="ros plain">0 </code><code class="ros keyword">$j</code><code class="ros plain">]&nbsp;;</code></div><div class="line number9 index8 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros plain">}</code></div><div class="line number10 index9 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros plain">}</code></div><div class="line number11 index10 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros plain">}</code></div><div class="line number12 index11 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros plain">}</code></div><div class="line number13 index12 alt2" data-bidi-marker="true"><code class="ros plain">}</code></div></div></td></tr></tbody></table>

  

# Block access to specific websites

This script is useful if you want to block certain websites but you don't want to use a web proxy.

This example looks at entries "Rapidshare" and "youtube" in the DNS cache and adds IPs to the address list named "restricted". Before you begin, you must set up a router to catch all DNS requests:

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2" data-bidi-marker="true"><code class="ros constants">/ip firewall nat</code></div><div class="line number2 index1 alt1" data-bidi-marker="true"><code class="ros functions">add </code><code class="ros value">action</code><code class="ros plain">=redirect</code> <code class="ros value">chain</code><code class="ros plain">=dstnat</code> <code class="ros value">comment</code><code class="ros plain">=DNS</code> <code class="ros value">dst-port</code><code class="ros plain">=53</code> <code class="ros value">protocol</code><code class="ros plain">=tcp</code> <code class="ros value">to-ports</code><code class="ros plain">=53</code></div><div class="line number3 index2 alt2" data-bidi-marker="true"><code class="ros functions">add </code><code class="ros value">action</code><code class="ros plain">=redirect</code> <code class="ros value">chain</code><code class="ros plain">=dstnat</code> <code class="ros value">dst-port</code><code class="ros plain">=53</code> <code class="ros value">protocol</code><code class="ros plain">=udp</code> <code class="ros value">to-ports</code><code class="ros plain">=53</code></div></div></td></tr></tbody></table>

  

and add firewall

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2" data-bidi-marker="true"><code class="ros constants">/ip firewall filter</code></div><div class="line number2 index1 alt1" data-bidi-marker="true"><code class="ros functions">add </code><code class="ros value">chain</code><code class="ros plain">=forward</code> <code class="ros value">dst-address-list</code><code class="ros plain">=restricted</code> <code class="ros value">action</code><code class="ros plain">=drop</code></div></div></td></tr></tbody></table>

  

Now we can write a script and schedule it to run, let's say, every 30 seconds.

Script Code:

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">foreach </code><code class="ros plain">i </code><code class="ros value">in</code><code class="ros plain">=[/ip</code> <code class="ros plain">dns cache find] </code><code class="ros value">do</code><code class="ros plain">=</code><code class="ros plain">{</code></div><div class="line number2 index1 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">local </code><code class="ros plain">bNew </code><code class="ros string">"true"</code><code class="ros plain">;</code></div><div class="line number3 index2 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">local </code><code class="ros plain">cacheName [</code><code class="ros constants">/ip dns cache all </code><code class="ros functions">get </code><code class="ros keyword">$i</code> <code class="ros plain">name]&nbsp;;</code></div><div class="line number4 index3 alt1" data-bidi-marker="true"><code class="ros comments">#&nbsp;&nbsp;&nbsp; :put $cacheName;</code></div><div class="line number5 index4 alt2" data-bidi-marker="true">&nbsp;</div><div class="line number6 index5 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">if </code><code class="ros plain">(([</code><code class="ros constants">:</code><code class="ros functions">find </code><code class="ros keyword">$cacheName</code> <code class="ros string">"rapidshare"</code><code class="ros plain">] &gt;</code><code class="ros plain">=</code> <code class="ros plain">0) || ([</code><code class="ros constants">:</code><code class="ros functions">find </code><code class="ros keyword">$cacheName</code> <code class="ros string">"youtube"</code><code class="ros plain">] &gt;</code><code class="ros plain">=</code> <code class="ros plain">0)) </code><code class="ros value">do</code><code class="ros plain">=</code><code class="ros plain">{</code></div><div class="line number7 index6 alt2" data-bidi-marker="true">&nbsp;</div><div class="line number8 index7 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">local </code><code class="ros plain">tmpAddress [</code><code class="ros constants">/ip dns cache </code><code class="ros functions">get </code><code class="ros keyword">$i</code> <code class="ros plain">address]&nbsp;;</code></div><div class="line number9 index8 alt2" data-bidi-marker="true"><code class="ros comments">#&nbsp;&nbsp; :put $tmpAddress;</code></div><div class="line number10 index9 alt1" data-bidi-marker="true">&nbsp;</div><div class="line number11 index10 alt2" data-bidi-marker="true"><code class="ros comments"># if address list is empty do not check</code></div><div class="line number12 index11 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">if </code><code class="ros plain">( [</code><code class="ros constants">/ip firewall address-list </code><code class="ros functions">find </code><code class="ros value">list</code><code class="ros plain">=</code><code class="ros string">"restricted"</code> <code class="ros plain">] </code><code class="ros plain">=</code> <code class="ros string">""</code><code class="ros plain">) </code><code class="ros value">do</code><code class="ros plain">=</code><code class="ros plain">{</code></div><div class="line number13 index12 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">log </code><code class="ros functions">info </code><code class="ros plain">(</code><code class="ros string">"added entry: $[/ip dns cache get $i name] IP $tmpAddress"</code><code class="ros plain">);</code></div><div class="line number14 index13 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">/ip firewall address-list </code><code class="ros functions">add </code><code class="ros value">address</code><code class="ros plain">=$tmpAddress</code> <code class="ros value">list</code><code class="ros plain">=restricted</code> <code class="ros value">comment</code><code class="ros plain">=$cacheName</code><code class="ros plain">;</code></div><div class="line number15 index14 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros plain">} </code><code class="ros value">else</code><code class="ros plain">=</code><code class="ros plain">{</code></div><div class="line number16 index15 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">foreach </code><code class="ros plain">j </code><code class="ros value">in</code><code class="ros plain">=[/ip</code> <code class="ros plain">firewall address-list </code><code class="ros functions">find </code><code class="ros value">list</code><code class="ros plain">=</code><code class="ros string">"restricted"</code><code class="ros plain">] </code><code class="ros value">do</code><code class="ros plain">=</code><code class="ros plain">{</code></div><div class="line number17 index16 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">if </code><code class="ros plain">( [</code><code class="ros constants">/ip firewall address-list </code><code class="ros functions">get </code><code class="ros keyword">$j</code> <code class="ros plain">address] </code><code class="ros plain">=</code> <code class="ros keyword">$tmpAddress</code> <code class="ros plain">) </code><code class="ros value">do</code><code class="ros plain">=</code><code class="ros plain">{</code></div><div class="line number18 index17 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">set </code><code class="ros plain">bNew </code><code class="ros string">"false"</code><code class="ros plain">;</code></div><div class="line number19 index18 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros plain">}</code></div><div class="line number20 index19 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros plain">}</code></div><div class="line number21 index20 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">if </code><code class="ros plain">( </code><code class="ros keyword">$bNew</code> <code class="ros plain">=</code> <code class="ros string">"true"</code> <code class="ros plain">) </code><code class="ros value">do</code><code class="ros plain">=</code><code class="ros plain">{</code></div><div class="line number22 index21 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">log </code><code class="ros functions">info </code><code class="ros plain">(</code><code class="ros string">"added entry: $[/ip dns cache get $i name] IP $tmpAddress"</code><code class="ros plain">);</code></div><div class="line number23 index22 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">/ip firewall address-list </code><code class="ros functions">add </code><code class="ros value">address</code><code class="ros plain">=$tmpAddress</code> <code class="ros value">list</code><code class="ros plain">=restricted</code> <code class="ros value">comment</code><code class="ros plain">=$cacheName</code><code class="ros plain">;</code></div><div class="line number24 index23 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros plain">}</code></div><div class="line number25 index24 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros plain">}</code></div><div class="line number26 index25 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros plain">}</code></div><div class="line number27 index26 alt2" data-bidi-marker="true"><code class="ros plain">}</code></div></div></td></tr></tbody></table>

  

# Parse file to add ppp secrets

This script requires that entries inside the file are in the following format:

username,password,local\_address,remote\_address,profile,service

For example:

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2" data-bidi-marker="true"><code class="ros plain">janis,123,1.1.1.1,2.2.2.1,ppp_profile,myService</code></div><div class="line number2 index1 alt1" data-bidi-marker="true"><code class="ros plain">juris,456,1.1.1.1,2.2.2.2,ppp_profile,myService</code></div><div class="line number3 index2 alt2" data-bidi-marker="true"><code class="ros plain">aija,678,1.1.1.1,2.2.2.3,ppp_profile,myService</code></div></div></td></tr></tbody></table>

  

  

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">content [</code><code class="ros constants">/</code><code class="ros functions">file </code><code class="ros functions">get </code><code class="ros plain">[</code><code class="ros constants">/</code><code class="ros functions">file </code><code class="ros functions">find </code><code class="ros value">name</code><code class="ros plain">=test.txt]</code> <code class="ros plain">contents]&nbsp;;</code></div><div class="line number2 index1 alt1" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">contentLen [ </code><code class="ros constants">:</code><code class="ros functions">len </code><code class="ros keyword">$content</code> <code class="ros plain">]&nbsp;;</code></div><div class="line number3 index2 alt2" data-bidi-marker="true">&nbsp;</div><div class="line number4 index3 alt1" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">lineEnd 0;</code></div><div class="line number5 index4 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">line </code><code class="ros string">""</code><code class="ros plain">;</code></div><div class="line number6 index5 alt1" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">lastEnd 0;</code></div><div class="line number7 index6 alt2" data-bidi-marker="true">&nbsp;</div><div class="line number8 index7 alt1" data-bidi-marker="true">&nbsp;</div><div class="line number9 index8 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">do </code><code class="ros plain">{</code></div><div class="line number10 index9 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">set </code><code class="ros plain">lineEnd [</code><code class="ros constants">:</code><code class="ros functions">find </code><code class="ros keyword">$content</code> <code class="ros string">"\r\n"</code> <code class="ros keyword">$lastEnd</code> <code class="ros plain">]&nbsp;;</code></div><div class="line number11 index10 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">set </code><code class="ros plain">line [</code><code class="ros constants">:</code><code class="ros functions">pick </code><code class="ros keyword">$content</code> <code class="ros keyword">$lastEnd</code> <code class="ros keyword">$lineEnd</code><code class="ros plain">]&nbsp;;</code></div><div class="line number12 index11 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">set </code><code class="ros plain">lastEnd ( </code><code class="ros keyword">$lineEnd</code> <code class="ros plain">+ 2 )&nbsp;;</code></div><div class="line number13 index12 alt2" data-bidi-marker="true">&nbsp;</div><div class="line number14 index13 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">local </code><code class="ros plain">tmpArray [</code><code class="ros constants">:</code><code class="ros functions">toarray </code><code class="ros keyword">$line</code><code class="ros plain">]&nbsp;;</code></div><div class="line number15 index14 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">if </code><code class="ros plain">( [</code><code class="ros constants">:</code><code class="ros functions">pick </code><code class="ros keyword">$tmpArray</code> <code class="ros plain">0]&nbsp;!</code><code class="ros plain">=</code> <code class="ros string">""</code> <code class="ros plain">) </code><code class="ros value">do</code><code class="ros plain">=</code><code class="ros plain">{</code></div><div class="line number16 index15 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">put </code><code class="ros keyword">$tmpArray</code><code class="ros plain">;</code></div><div class="line number17 index16 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">/ppp secret </code><code class="ros functions">add </code><code class="ros value">name</code><code class="ros plain">=[:pick</code> <code class="ros keyword">$tmpArray</code> <code class="ros plain">0] </code><code class="ros value">password</code><code class="ros plain">=[:pick</code> <code class="ros keyword">$tmpArray</code> <code class="ros plain">1] \</code></div><div class="line number18 index17 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros value">local-address</code><code class="ros plain">=[:pick</code> <code class="ros keyword">$tmpArray</code> <code class="ros plain">2] </code><code class="ros value">remote-address</code><code class="ros plain">=[:pick</code> <code class="ros keyword">$tmpArray</code> <code class="ros plain">3] \</code></div><div class="line number19 index18 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros value">profile</code><code class="ros plain">=[:pick</code> <code class="ros keyword">$tmpArray</code> <code class="ros plain">4] </code><code class="ros value">service</code><code class="ros plain">=[:pick</code> <code class="ros keyword">$tmpArray</code> <code class="ros plain">5];</code></div><div class="line number20 index19 alt1" data-bidi-marker="true"><code class="ros plain">}</code></div><div class="line number21 index20 alt2" data-bidi-marker="true"><code class="ros plain">} </code><code class="ros functions">while </code><code class="ros plain">(</code><code class="ros keyword">$lineEnd</code> <code class="ros plain">&lt; </code><code class="ros keyword">$contentLen</code><code class="ros plain">)</code></div></div></td></tr></tbody></table>

  

# Detect new log entry

This script is checking if a new log entry is added to a particular buffer.

In this example we will use PPPoE logs:

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2" data-bidi-marker="true"><code class="ros constants">/system logging action</code></div><div class="line number2 index1 alt1" data-bidi-marker="true"><code class="ros functions">add </code><code class="ros value">name</code><code class="ros plain">=</code><code class="ros string">"pppoe"</code></div><div class="line number3 index2 alt2" data-bidi-marker="true"><code class="ros constants">/system logging</code></div><div class="line number4 index3 alt1" data-bidi-marker="true"><code class="ros functions">add </code><code class="ros value">action</code><code class="ros plain">=pppoe</code> <code class="ros value">topics</code><code class="ros plain">=pppoe,info,!ppp,!debug</code></div></div></td></tr></tbody></table>

  

Log buffer will look similar to this one:

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2" data-bidi-marker="true"><code class="ros plain">[admin@mainGW] &gt; </code><code class="ros constants">/</code><code class="ros functions">log </code><code class="ros functions">print </code><code class="ros plain">where </code><code class="ros value">buffer</code><code class="ros plain">=pppoe</code></div><div class="line number2 index1 alt1" data-bidi-marker="true"><code class="ros plain">13</code><code class="ros constants">:11:08 pppoe,</code><code class="ros functions">info </code><code class="ros plain">PPPoE connection established from 00</code><code class="ros constants">:0C:42:04:4C:EE</code></div></div></td></tr></tbody></table>

  

Now we can write a script to detect if a new entry is added.

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">lastTime;</code></div><div class="line number2 index1 alt1" data-bidi-marker="true">&nbsp;</div><div class="line number3 index2 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">currentBuf [ </code><code class="ros constants">:</code><code class="ros functions">toarray </code><code class="ros plain">[ </code><code class="ros constants">/</code><code class="ros functions">log </code><code class="ros functions">find </code><code class="ros value">buffer</code><code class="ros plain">=pppoe</code>&nbsp; <code class="ros plain">] ]&nbsp;;</code></div><div class="line number4 index3 alt1" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">currentLineCount [ </code><code class="ros constants">:</code><code class="ros functions">len </code><code class="ros keyword">$currentBuf</code> <code class="ros plain">]&nbsp;;</code></div><div class="line number5 index4 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">currentTime [ </code><code class="ros constants">:</code><code class="ros functions">totime </code><code class="ros plain">[</code><code class="ros constants">/</code><code class="ros functions">log </code><code class="ros functions">get </code><code class="ros plain">[ </code><code class="ros constants">:</code><code class="ros functions">pick </code><code class="ros keyword">$currentBuf</code> <code class="ros plain">(</code><code class="ros keyword">$currentLineCount</code> <code class="ros plain">-1) ] </code><code class="ros functions">time </code>&nbsp; <code class="ros plain">] ];</code></div><div class="line number6 index5 alt1" data-bidi-marker="true">&nbsp;</div><div class="line number7 index6 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">message </code><code class="ros string">""</code><code class="ros plain">;</code></div><div class="line number8 index7 alt1" data-bidi-marker="true">&nbsp;</div><div class="line number9 index8 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">if </code><code class="ros plain">( </code><code class="ros keyword">$lastTime</code> <code class="ros plain">=</code> <code class="ros string">""</code> <code class="ros plain">) </code><code class="ros value">do</code><code class="ros plain">=</code><code class="ros plain">{</code></div><div class="line number10 index9 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">set </code><code class="ros plain">lastTime </code><code class="ros keyword">$currentTime</code>&nbsp;<code class="ros plain">;</code></div><div class="line number11 index10 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">set </code><code class="ros plain">message [</code><code class="ros constants">/</code><code class="ros functions">log </code><code class="ros functions">get </code><code class="ros plain">[ </code><code class="ros constants">:</code><code class="ros functions">pick </code><code class="ros keyword">$currentBuf</code> <code class="ros plain">(</code><code class="ros keyword">$currentLineCount</code><code class="ros plain">-1) ] message];</code></div><div class="line number12 index11 alt1" data-bidi-marker="true">&nbsp;</div><div class="line number13 index12 alt2" data-bidi-marker="true"><code class="ros plain">} </code><code class="ros value">else</code><code class="ros plain">=</code><code class="ros plain">{</code></div><div class="line number14 index13 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">if </code><code class="ros plain">( </code><code class="ros keyword">$lastTime</code> <code class="ros plain">&lt; </code><code class="ros keyword">$currentTime</code> <code class="ros plain">) </code><code class="ros value">do</code><code class="ros plain">=</code><code class="ros plain">{</code></div><div class="line number15 index14 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">set </code><code class="ros plain">lastTime </code><code class="ros keyword">$currentTime</code>&nbsp;<code class="ros plain">;</code></div><div class="line number16 index15 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">set </code><code class="ros plain">message [</code><code class="ros constants">/</code><code class="ros functions">log </code><code class="ros functions">get </code><code class="ros plain">[ </code><code class="ros constants">:</code><code class="ros functions">pick </code><code class="ros keyword">$currentBuf</code> <code class="ros plain">(</code><code class="ros keyword">$currentLineCount</code><code class="ros plain">-1) ] message];</code></div><div class="line number17 index16 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros plain">}</code></div><div class="line number18 index17 alt1" data-bidi-marker="true"><code class="ros plain">}</code></div></div></td></tr></tbody></table>

  

After a new entry is detected, it is saved in the "message" variable, which you can use later to parse log messages, for example, to get the PPPoE client's mac addresses.

# Allow use of [ntp.org](http://ntp.org) pool service for NTP

This script resolves the hostnames of two NTP servers, compares the result with the current NTP settings, and changes the addresses if they're different. This script is required as RouterOS does not allow hostnames to be used in the NTP configuration. Two scripts are used. The first defines some system variables which are used in other scripts and the second does the grunt work:

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2" data-bidi-marker="true"><code class="ros comments"># System configuration script - "GlobalVars"</code></div><div class="line number2 index1 alt1" data-bidi-marker="true">&nbsp;</div><div class="line number3 index2 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">put </code><code class="ros string">"Setting system globals"</code><code class="ros plain">;</code></div><div class="line number4 index3 alt1" data-bidi-marker="true">&nbsp;</div><div class="line number5 index4 alt2" data-bidi-marker="true"><code class="ros comments"># System name</code></div><div class="line number6 index5 alt1" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">SYSname [</code><code class="ros constants">/system identity </code><code class="ros functions">get </code><code class="ros plain">name];</code></div><div class="line number7 index6 alt2" data-bidi-marker="true">&nbsp;</div><div class="line number8 index7 alt1" data-bidi-marker="true"><code class="ros comments"># E-mail address to send notifications to</code></div><div class="line number9 index8 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">SYSsendemail </code><code class="ros string">"mail@my.address"</code><code class="ros plain">;</code></div><div class="line number10 index9 alt1" data-bidi-marker="true">&nbsp;</div><div class="line number11 index10 alt2" data-bidi-marker="true"><code class="ros comments"># E-mail address to send notifications from</code></div><div class="line number12 index11 alt1" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">SYSmyemail </code><code class="ros string">"routeros@my.address"</code><code class="ros plain">;</code></div><div class="line number13 index12 alt2" data-bidi-marker="true">&nbsp;</div><div class="line number14 index13 alt1" data-bidi-marker="true"><code class="ros comments"># Mail server to use</code></div><div class="line number15 index14 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">SYSemailserver </code><code class="ros string">"1.2.3.4"</code><code class="ros plain">;</code></div><div class="line number16 index15 alt1" data-bidi-marker="true">&nbsp;</div><div class="line number17 index16 alt2" data-bidi-marker="true"><code class="ros comments"># NTP pools to use (check www.pool.ntp.org)</code></div><div class="line number18 index17 alt1" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">SYSntpa </code><code class="ros string">"0.uk.pool.ntp.org"</code><code class="ros plain">;</code></div><div class="line number19 index18 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">SYSntpb </code><code class="ros string">"1.uk.pool.ntp.org"</code><code class="ros plain">;</code></div></div></td></tr></tbody></table>

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2" data-bidi-marker="true"><code class="ros comments"># Check and set NTP servers - "setntppool"</code></div><div class="line number2 index1 alt1" data-bidi-marker="true">&nbsp;</div><div class="line number3 index2 alt2" data-bidi-marker="true"><code class="ros comments"># We need to use the following globals which must be defined here even</code></div><div class="line number4 index3 alt1" data-bidi-marker="true"><code class="ros comments"># though they are also defined in the script we call to set them.</code></div><div class="line number5 index4 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">SYSname;</code></div><div class="line number6 index5 alt1" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">SYSsendemail;</code></div><div class="line number7 index6 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">SYSmyemail;</code></div><div class="line number8 index7 alt1" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">SYSmyname;</code></div><div class="line number9 index8 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">SYSemailserver;</code></div><div class="line number10 index9 alt1" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">SYSntpa;</code></div><div class="line number11 index10 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">global </code><code class="ros plain">SYSntpb;</code></div><div class="line number12 index11 alt1" data-bidi-marker="true">&nbsp;</div><div class="line number13 index12 alt2" data-bidi-marker="true"><code class="ros comments"># Load the global variables with the system defaults</code></div><div class="line number14 index13 alt1" data-bidi-marker="true"><code class="ros constants">/system script run GlobalVars</code></div><div class="line number15 index14 alt2" data-bidi-marker="true">&nbsp;</div><div class="line number16 index15 alt1" data-bidi-marker="true"><code class="ros comments"># Resolve the two ntp pool hostnames</code></div><div class="line number17 index16 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">local </code><code class="ros plain">ntpipa [</code><code class="ros constants">:</code><code class="ros functions">resolve </code><code class="ros keyword">$SYSntpa</code><code class="ros plain">];</code></div><div class="line number18 index17 alt1" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">local </code><code class="ros plain">ntpipb [</code><code class="ros constants">:</code><code class="ros functions">resolve </code><code class="ros keyword">$SYSntpb</code><code class="ros plain">];</code></div><div class="line number19 index18 alt2" data-bidi-marker="true">&nbsp;</div><div class="line number20 index19 alt1" data-bidi-marker="true"><code class="ros comments"># Get the current settings</code></div><div class="line number21 index20 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">local </code><code class="ros plain">ntpcura [</code><code class="ros constants">/system ntp client </code><code class="ros functions">get </code><code class="ros plain">primary-ntp];</code></div><div class="line number22 index21 alt1" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">local </code><code class="ros plain">ntpcurb [</code><code class="ros constants">/system ntp client </code><code class="ros functions">get </code><code class="ros plain">secondary-ntp];</code></div><div class="line number23 index22 alt2" data-bidi-marker="true">&nbsp;</div><div class="line number24 index23 alt1" data-bidi-marker="true"><code class="ros comments"># Define a variable so we know if anything's changed.</code></div><div class="line number25 index24 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">local </code><code class="ros plain">changea 0;</code></div><div class="line number26 index25 alt1" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">local </code><code class="ros plain">changeb 0;</code></div><div class="line number27 index26 alt2" data-bidi-marker="true">&nbsp;</div><div class="line number28 index27 alt1" data-bidi-marker="true"><code class="ros comments"># Debug output</code></div><div class="line number29 index28 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">put </code><code class="ros plain">(</code><code class="ros string">"Old: "</code> <code class="ros plain">. </code><code class="ros keyword">$ntpcura</code> <code class="ros plain">. </code><code class="ros string">" New: "</code> <code class="ros plain">. </code><code class="ros keyword">$ntpipa</code><code class="ros plain">);</code></div><div class="line number30 index29 alt1" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">put </code><code class="ros plain">(</code><code class="ros string">"Old: "</code> <code class="ros plain">. </code><code class="ros keyword">$ntpcurb</code> <code class="ros plain">. </code><code class="ros string">" New: "</code> <code class="ros plain">. </code><code class="ros keyword">$ntpipb</code><code class="ros plain">);</code></div><div class="line number31 index30 alt2" data-bidi-marker="true">&nbsp;</div><div class="line number32 index31 alt1" data-bidi-marker="true"><code class="ros comments"># Change primary if required</code></div><div class="line number33 index32 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">if </code><code class="ros plain">(</code><code class="ros keyword">$ntpipa</code>&nbsp;<code class="ros plain">!</code><code class="ros plain">=</code> <code class="ros keyword">$ntpcura</code><code class="ros plain">) </code><code class="ros value">do</code><code class="ros plain">=</code><code class="ros plain">{</code></div><div class="line number34 index33 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">put </code><code class="ros string">"Changing primary NTP"</code><code class="ros plain">;</code></div><div class="line number35 index34 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">/system ntp client </code><code class="ros functions">set </code><code class="ros value">primary-ntp</code><code class="ros plain">=</code><code class="ros string">"$ntpipa"</code><code class="ros plain">;</code></div><div class="line number36 index35 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">set </code><code class="ros plain">changea 1;</code></div><div class="line number37 index36 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros plain">}</code></div><div class="line number38 index37 alt1" data-bidi-marker="true">&nbsp;</div><div class="line number39 index38 alt2" data-bidi-marker="true"><code class="ros comments"># Change secondary if required</code></div><div class="line number40 index39 alt1" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">if </code><code class="ros plain">(</code><code class="ros keyword">$ntpipb</code>&nbsp;<code class="ros plain">!</code><code class="ros plain">=</code> <code class="ros keyword">$ntpcurb</code><code class="ros plain">) </code><code class="ros value">do</code><code class="ros plain">=</code><code class="ros plain">{</code></div><div class="line number41 index40 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">put </code><code class="ros string">"Changing secondary NTP"</code><code class="ros plain">;</code></div><div class="line number42 index41 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">/system ntp client </code><code class="ros functions">set </code><code class="ros value">secondary-ntp</code><code class="ros plain">=</code><code class="ros string">"$ntpipb"</code><code class="ros plain">;</code></div><div class="line number43 index42 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">set </code><code class="ros plain">changeb 1;</code></div><div class="line number44 index43 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros plain">}</code></div><div class="line number45 index44 alt2" data-bidi-marker="true">&nbsp;</div><div class="line number46 index45 alt1" data-bidi-marker="true"><code class="ros comments"># If we've made a change, send an e-mail to say so.</code></div><div class="line number47 index46 alt2" data-bidi-marker="true"><code class="ros constants">:</code><code class="ros functions">if </code><code class="ros plain">((</code><code class="ros keyword">$changea</code> <code class="ros plain">=</code> <code class="ros plain">1) || (</code><code class="ros keyword">$changeb</code> <code class="ros plain">=</code> <code class="ros plain">1)) </code><code class="ros value">do</code><code class="ros plain">=</code><code class="ros plain">{</code></div><div class="line number48 index47 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">:</code><code class="ros functions">put </code><code class="ros string">"Sending e-mail."</code><code class="ros plain">;</code></div><div class="line number49 index48 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros constants">/tool e-mail </code><code class="ros functions">send </code><code class="ros plain">\</code></div><div class="line number50 index49 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros value">to</code><code class="ros plain">=$SYSsendemail</code> <code class="ros plain">\</code></div><div class="line number51 index50 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros value">subject</code><code class="ros plain">=($SYSname</code> <code class="ros plain">. </code><code class="ros string">" NTP change"</code><code class="ros plain">) \</code></div><div class="line number52 index51 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros value">from</code><code class="ros plain">=$SYSmyemail</code> <code class="ros plain">\</code></div><div class="line number53 index52 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros value">server</code><code class="ros plain">=$SYSemailserver</code> <code class="ros plain">\</code></div><div class="line number54 index53 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros value">body</code><code class="ros plain">=(</code><code class="ros string">"Your NTP servers have just been changed:\n\nPrimary:\nOld: "</code> <code class="ros plain">. </code><code class="ros keyword">$ntpcura</code> <code class="ros plain">. </code><code class="ros string">"\nNew: "</code> <code class="ros plain">\</code></div><div class="line number55 index54 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros plain">. </code><code class="ros keyword">$ntpipa</code> <code class="ros plain">. </code><code class="ros string">"\n\nSecondary\nOld: "</code> <code class="ros plain">. </code><code class="ros keyword">$ntpcurb</code> <code class="ros plain">. </code><code class="ros string">"\nNew: "</code> <code class="ros plain">. </code><code class="ros keyword">$ntpipb</code><code class="ros plain">);</code></div><div class="line number56 index55 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ros plain">}</code></div></div></td></tr></tbody></table>

Scheduler entry:

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2" data-bidi-marker="true"><code class="ros constants">/system scheduler </code><code class="ros functions">add </code><code class="ros plain">\</code></div><div class="line number2 index1 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;</code><code class="ros value">comment</code><code class="ros plain">=</code><code class="ros string">"Check and set NTP servers"</code> <code class="ros plain">\</code></div><div class="line number3 index2 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;</code><code class="ros value">disabled</code><code class="ros plain">=no</code> <code class="ros plain">\</code></div><div class="line number4 index3 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;</code><code class="ros value">interval</code><code class="ros plain">=12h</code> <code class="ros plain">\</code></div><div class="line number5 index4 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;</code><code class="ros value">name</code><code class="ros plain">=CheckNTPServers</code> <code class="ros plain">\</code></div><div class="line number6 index5 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;</code><code class="ros value">on-event</code><code class="ros plain">=setntppool</code> <code class="ros plain">\</code></div><div class="line number7 index6 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;</code><code class="ros value">policy</code><code class="ros plain">=read,write,test</code> <code class="ros plain">\</code></div><div class="line number8 index7 alt1" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;</code><code class="ros value">start-date</code><code class="ros plain">=jan/01/1970</code> <code class="ros plain">\</code></div><div class="line number9 index8 alt2" data-bidi-marker="true"><code class="ros spaces">&nbsp;&nbsp;</code><code class="ros value">start-time</code><code class="ros plain">=16:00:00</code></div></div></td></tr></tbody></table>

# Other scripts

-   [Dynamic\_DNS\_Update\_Script\_for\_EveryDNS](https://wiki.mikrotik.com/wiki/Dynamic_DNS_Update_Script_for_EveryDNS "Dynamic DNS Update Script for EveryDNS")
-   [Dynamic\_DNS\_Update\_Script\_for\_ChangeIP.com](https://wiki.mikrotik.com/wiki/Dynamic_DNS_Update_Script_for_ChangeIP.com "Dynamic DNS Update Script for ChangeIP.com")
-   [UPS Script](https://wiki.mikrotik.com/wiki/UPS_scripts#version_for_ROS_3.x "UPS scripts")