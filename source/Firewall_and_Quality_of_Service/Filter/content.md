# 介绍

防火墙过滤器可以允许或阻止转发到本地网络的特定数据包，这些数据包来自路由器，或以路由器为目的。

有两种方法可以设置过滤：

  - 允许特定流量，丢弃其他的
  - 只丢弃恶意流量，其他都允许

两种方法都有优缺点，例如，从安全的角度来看，第一种方法更安全，但每当需要接受新服务的流量时，需要管理员输入。这种策略提供了对流量的良好控制，减少了由于服务配置错误而发生漏洞的可能性。

另一方面，在确保客户网络的安全时，接受用户可能使用的所有服务将是一场管理噩梦。因此，在高级设置中，对防火墙的仔细规划是必不可少的。

防火墙过滤器由三个预定义的链组成，不能删除。

![](https://help.mikrotik.com/docs/download/attachments/48660574/Pfd1.png?version=1&modificationDate=1608285888724&api=v2)

- **input** - 处理通过其中一个接口进入路由器的数据包，目的IP地址是路由器的地址之一。通过路由器的数据包不按照输入链的规则处理。
- **forward** - 处理通过路由器的数据包
- **output** - 处理来自路由器的数据包，并通过其中一个接口离开路由器。通过路由器的数据包不按照输出链的规则处理。

处理一个链时，规则按照从上到下的顺序从该链中取出。如果数据包符合规则条件，那么就对它进行指定的操作，并且不再处理该链中的其他规则（穿透操作例外）。如果数据包没有匹配内置链中的任何规则，那就被接受。 RouterOS中更详细的数据包处理在 [Packet Flow in RouterOS](https://help.mikrotik.com/docs/display/ROS/Packet+Flow+in+RouterOS) 图中描述。

## IPv4

## 属性

| 属性                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 说明                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **action** (_action name_; Default: **accept**)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | 数据包被该规则匹配时采取的行动。<br>- accept - 接受数据包。数据包不会传递到下一个防火墙规则。<br>- add-dst-to-address-list - 将目标地址添加到参数 "address-list "指定的地址列表中。<br>- add-src-to-address-list - 将源地址添加到参数 "address-list "指定的地址列表中。<br>- drop - 无声地丢弃数据包<br>- fasttrack-connection - 为连接启用 [FastTrack](https://wiki.mikrotik.com/wiki/Manual:IP/Fasttrack "Manual:IP/Fasttrack") 来处理来自使用FastPath的连接的数据包<br>- jump - 跳到由 `jump-target` 参数指定的用户定义的链上<br>- log - 在系统日志中添加一条信息，包含以下数据：in-interface, out-interface, src-mac, protocol, src-ip:port->dst-ip:port和数据包的长度。在数据包匹配后，传递到列表中的下一个规则，类似于 `passthrough`。<br>- passthrough - 如果数据包被规则匹配，增加计数器并转到下一个规则（对统计很有用）<br>- reject - 丢弃数据包并发送一个ICMP拒绝消息<br>- return - 将控制权传回发生跳转的链上<br>- tarpit - 捕获并保持TCP连接（用SYN/ACK回复入站的TCP SYN包）。 |
| **address-list-timeout** (_none-dynamic \| none-static \| time_; Default: **none-dynamic**)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | 地址从`address-list`参数指定的地址列表中删除的时间间隔。与 `add-dst-to-address-list` 或 `add-src-to-address-list` 动作一起使用。<br>- 非动态值(`00:00:00`)将在地址列表中保留该地址，直到重新启动。<br>- 非静态的值将使地址永远留在地址列表中，并将包括在配置导出/备份中。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **chain** (_name_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | 指定添加到哪个链的规则。如果输入的内容和已定义链的名称不一致，将创建一个新的链。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **comment** (_string_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | 规则的描述性说明。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **chain** (_name_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | 指定规则添加到哪个链中。如果输入的内容和已定义的链名称不一致，将创建一个新的链。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **comment** (_string_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | 规则的描述性说明。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **connection-bytes** (_integer-integer_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 只有在通过特定连接传输了一定数量的字节时才会匹配数据包。0 - 表示无穷大，例如 `connection-bytes=2000000-0` 表示如果通过相关连接的传输量超过2MB，该规则就会匹配。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **connection-limit** (_integer,netmask_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 达到给定值后，匹配每个地址或地址块的连接。和connection-state=new或tcp-flags=syn一起使用，因为匹配器非常耗费资源。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **connection-mark** (_no-mark \| string_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 匹配通过mangle设施标记为特定连接标记的数据包。如果设置了 **无标记**，该规则将匹配任何无标记的连接。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **connection-nat-state** (_srcnat \| dstnat_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | 匹配srcnatted、distracted或两者的连接。注意connection-state=related连接connection-nat-state是由第一个数据包的方向决定的。如果连接跟踪要用dst-nat把这个连接传递到与主连接相同的主机上，它将处于connection-nat-state=dstnat，即使根本没有dst-nat规则                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 。 |
| **connection-rate** (_Integer 0..4294967295_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | 连接速率是一个防火墙匹配器，允许根据目前的连接速率来捕获流量。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **connection-state** (_established \| invalid \| new \| related \| untracked_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | 解释特定数据包的连接跟踪分析数据。<br>- established - 属于现有连接的数据包<br>- invalid - 在连接跟踪中没有确定状态的数据包（通常是 - 严重失序的数据包，序列号/ack号错误的数据包，或者在路由器上资源过度使用的情况下），由于这个原因，无效的数据包不会参与NAT（只有connection-state=new的数据包），并且在路由时仍然包含原始源IP地址。建议在防火墙过滤器转发和输入链中丢弃所有 _connection-state=invalid_ 的数据包。<br>- new - 数据包开始一个新的连接，或者与一个没有在两个方向上看到数据包的连接相关。<br>- related - 一个和现有连接相关的数据包，但不是现有连接的一部分，例如ICMP错误或开始FTP数据连接的数据包<br>- untracked - 在防火墙 [RAW](https://wiki.mikrotik.com/wiki/Manual:IP/Firewall/Raw "Manual:IP/Firewall/Raw") 表中被设置为绕过连接跟踪的数据包。                                                                                                                                                                                                                         |
| **connection-type** (_ftp \| h323 \| irc \| pptp \| quake3 \| sip \| tftp_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 根据相关连接追踪帮助器的信息，匹配来自相关连接的数据包。相关的连接帮助器必须在以下位置启用。/ip firewall service-port                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **content** (_string_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | 匹配包含指定文本的数据包                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **dscp** (_integer: 0..63_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 匹配DSCP IP头。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **dst-address** (_IP/netmask                                                                \| IP range_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 匹配目的地等于指定IP或属于指定IP范围的数据包。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **dst-address-list** (_name_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | 将数据包的目的地址和用户定义的地址列表进行匹配。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **dst-address-type** (_unicast                                                                                       \| local                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \| broadcast \| multicast_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | 匹配目的地址类型。<br>- unicast - 用于点对点传输的IP地址<br>- local - 如果dst-address分配给路由器的一个接口<br>- broadcast - 数据包发送到子网的所有设备上<br>- multicast - 数据包转发到一个定义的设备组中                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **dst-limit** (_integer[/time],integer,dst-address \| dst-port \| src-address[/time]_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | 匹配数据包，直到超过给定速率。速率被定义为每个时间间隔的数据包。与限制匹配器相反，每个流都有自己的限制。流量由一个模式参数定义。参数以下列格式书写。`rate[/time],burst,mode[/expire]`.<br>- **rate** - 匹配每个流的时间间隔数据包计数<br>- **time** - 每个流的数据包计数率不能超过的时间间隔（可选，如果不指定将使用1s）。<br>- **burst** - 每个流匹配的数据包的初始数量：这个数字每隔 `time`/`rate` 就会增加一个，最多到这个数字。<br>- **mode** - 这个参数指定了定义流的独特字段（src-address, dst-address, src-and-dst-address, dst-address-and-port, addresses-and-dst-port)<br>- **expire** - 指定没有数据包的流允许删除的时间间隔（可选）。                                                                                                                                                                                                                                                                                                                                          |
| **dst-port** (_integer[-integer]: 0...65535_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | 目标端口号或端口号范围列表                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **fragment** (_yes\|no_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 匹配碎片化的数据包。第一个（开始）片段不计入。如果启用连接跟踪功能，就不会有碎片，因为系统会自动组合每个数据包。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **hotspot** (_auth \| from-client \| http \| local-dst \| to-client_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | 根据各种HotSpot匹配器匹配从HotSpot客户端收到的数据包。<br>- auth - 匹配经过认证的HotSpot客户端数据包<br>- from-client - 匹配来自HotSpot客户端的数据包<br>- http - 匹配发送到HotSpot服务器的HTTP请求<br>- local-dst - 匹配以HotSpot服务器为目的地的数据包<br>- to-client - 匹配发送至HotSpot客户端的数据包。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **icmp-options** (_integer:integer_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | 匹配ICMP类型：代码字段                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **in-bridge-port** (_name_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 如果传入的接口是网桥，则数据包进入路由器的实际接口。只有在桥接设置中启用了 **使用ip-firewall** 时才起作用。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **in-bridge-port-list** (_name_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | 在接口列表中定义的一组接口。作用与in-bridge-port 相同。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **in-interface** (_name_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 数据包进入路由器的接口。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **in-interface-list** (_name_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | 在接口列表中定义的一组接口。与in-interface的作用相同。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **ingress-priority** (_integer: 0..63_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | 匹配入站数据包的优先级。优先级可以从VLAN、WMM、DSCP或MPLS EXP位中得到。[阅读全文](https://help.mikrotik.com/docs/display/ROS/WMM+and+VLAN+priority)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **ipsec-policy** (_in                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \| out, ipsec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \| none_; Default: ) | 匹配IPsec策略。值按下列格式书写：**方向，策略**。方向用于选择是否匹配解封装策略或封装策略。<br>- in - 在PREROUTING、INPUT和FORWARD链中有效<br>- out - 在POSTROUTING、OUTPUT和FORWARD链中有效。<br>- ipsec - 匹配数据包是否接受IPsec处理。<br>- none - 匹配不受IPsec处理的数据包（例如，IPSec传输数据包）。<br>例如，如果路由器收到一个IPsec封装的Gre包，那么规则 `ipsec-policy=in,ipsec` 将匹配Gre包，但规则 `ipsec-policy=in,none` 将匹配ESP包。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **ipv4-options** (_any \| loose-source-routing \| no-record-route \| no-router-alert \| no-source-routing \| no-timestamp \| none \| record-route \| router-alert \| strict-source-routing \| timestamp_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 匹配IPv4头的选项。<br>- any - 匹配至少一个IPv4选项的数据包。<br>- loose-source-routing - 匹配带有松散源路由选项的数据包。用于根据源提供的信息对互联网数据报进行路由。<br>- no-record-route - 匹配没有记录路由选项的数据包。用于根据源提供的信息对互联网数据报进行路由。<br>- no-router-alert - 匹配没有路由器改变选项的数据包<br>- no-source-routing - 匹配没有源路由选项的数据包<br>- no-timestamp - 匹配没有时间戳选项的数据包<br>- record-route - 匹配带有record route选项的数据包<br>- router-alert - 匹配带有router alter选项的数据包<br>- strict-source-routing - 匹配有严格源路由选项的数据包<br>- timestamp - 匹配有时间戳的数据包                                                                                                                                                                                                                                                                                                                                                 |
| **jump-target** (_name_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 要跳到的目标链名称。仅在 `action=jump` 时用。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **layer7-protocol** (_name_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | 第七层协议菜单中定义的第七层过滤器名称。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **limit** (_integer,time,integer_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | 匹配达到限定速率（包速率或比特速率）的数据包。使用该匹配器的规则进行匹配，直到达到该限制。参数以下列格式写入。`rate[/time],burst:mode`.<br>- **rate** - 匹配每次间隔的数据包或比特数<br>- **time** - 指定不超过数据包或比特率的时间间隔（可选，如果不指定将使用1s）。<br>- **burst** - 匹配的数据包或比特的初始数量：这个数字每10ms就会被填充，所以burst应该至少是每秒速率的1/100<br>- **mode** - 数据包或比特模式                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **log** (_yes \| no; Default:_ **no**)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 在系统日志中添加一条消息，包含以下数据：in-interface、out-interface、src-mac、协议、src-ip:port->dst-ip:port，以及数据包的长度。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **log-prefix** (_string_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 在每条日志信息的开头添加指定的文本。如果配置了 _action=log_ 或 _log=yes_，则适用。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **nth** (_integer,integer_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 匹配第n个数据包。_nth=2,1_ 规则匹配每一个数据包的第2个，因此，50%的流量被该规则匹配。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **out-bridge-port** (_name_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | 如果出站的接口是网桥，则为数据包离开路由器的实际接口。只有在桥接设置中启用了 **use-ip-firewall** 时才起作用。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **out-bridge-port-list** (_name_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | 在接口列表中定义的一组接口。与out-bridge-port的作用相同                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **out-interface** (; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | 数据包离开路由器时的接口                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **out-interface-list** (_name_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | 在接口列表中定义的一组接口。与out-interface的作用相同                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **packet-mark** (_no-mark                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \| string_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | 匹配通过mangle设施标记的有特定标记的数据包。如果设置了 **无标记**，该规则将匹配任何无标记的数据包。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **packet-size** (_integer[-integer]:0..65535_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | 匹配指定大小或大小范围的数据包，单位为字节。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **per-connection-classifier** (_ValuesToHash:Denominator/Remainder_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | PCC匹配器允许把流量分为相等的流，并把有特定选项集的数据包保留在一个特定的流中。[阅读全文](https://wiki.mikrotik.com/wiki/Manual:PCC "Manual:PCC")                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **port** (_integer[-integer]: 0..65535_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 如果任何源或目的端口和指定的端口或端口范围列表相匹配，则进行匹配。仅当 `protocol` 为TCP或UDP时适用。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **priority** (_integer: 0..63_; Default:)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | 匹配数据包设置了新的优先级后的优先级。优先级可以来自VLAN、WMM、DSCP、MPLS EXP位，或者来自使用set-priority设置的优先级。[阅读全文](https://help.mikrotik.com/docs/display/ROS/WMM+and+VLAN+priority)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **protocol** (_name or protocol ID_; Default: **tcp**)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 匹配由协议名称或编号指定的特定IP协议                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **psd** (_integer,time,integer,integer_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 尝试检测TCP和UDP扫描。参数的格式如下："WeightThreshold, DelayThreshold, LowPortWeight, HighPortWeight":<br>- **WeightThreshold** - 来自同一主机的不同目的端口的最新TCP/UDP数据包的总权重，被视为端口扫描序列。<br>- **DelayThreshold** - 来自同一主机的不同目的端口的数据包被视为可能的端口扫描子序列的延迟。<br>- **LowPortWeight** - 具有特权（<1024）目的端口的数据包的权重<br>- **HighPortWeight** - 具有非特权目的端口的数据包的权重                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **random** (_integer: 1..99_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | 以一定的概率随机匹配数据包。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **reject-with** (_icmp-admin-prohibited \| icmp-net-protocol-unreachable \| icmp-host-prohibited \| icmp-network-unreachable \| tcp-reset \| icmp-host-unreachable \| icmp-port-unreachable_; Default: icmp-network-unreachable)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | 如果数据包被拒绝，指定送回ICMP错误。当 `action=reject` 适用。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **routing-table** (_string_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | 匹配目的地址在特定路由表中被解析的数据包。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **routing-mark** (_string_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 匹配被混杂设施标记为特定路由标记的数据包。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **src-address** (_Ip/Netmask, Ip range_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 匹配来源等于指定IP或属于指定IP范围的数据包。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **src-address-list** (_name_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | 根据用户定义的地址列表匹配数据包的源地址。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **src-address-type** (_unicast \| local \| broadcast \| multicast_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | {ta{tableMatches源地址类型：<br>- unicast - 用于点对点传输的IP地址<br>- local - 如果一个地址被分配给路由器的一个接口<br>- broadcast - 数据包发送到子网的所有设备上<br>- multicast - 数据包转发到一个定义的设备组                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **src-port** (_integer[-integer]: 0..65535_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | 源端口和源端口范围列表。仅当协议为TCP或UDP时适用。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **src-mac-address** (_MAC address_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | 匹配数据包的源MAC地址                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **tcp-flags** (_ack \| cwr \| ece \| fin \| psh \| rst \| syn \| urg_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | 匹配指定的TCP标志<br>- ack - 确认数据<br>- cwr - 阻塞窗口减少<br>- ece - ECN-echo标志（明确的阻塞通知）<br>- fin - 关闭连接<br>- psh - 推送功能<br>- rst - 撤销连接<br>- syn - 新连接<br>- urg - 紧急数据                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **tcp-mss** (_integer[-integer]: 0..65535_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 匹配IP数据包的TCP MSS值                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **time** (_time-time,sat \| fri \| thu \| wed \| tue \| mon \| sun_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | 允许根据数据包的到达时间和日期创建一个过滤器，或者对于本地生成的数据包，根据离开时间和日期创建过滤器。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **tls-host** (_string_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | 允许根据TLS SNI主机名来匹配HTTPS流量。接受 [GLOB语法](https://en.wikipedia.org/wiki/Glob_(programming)) 进行通配符匹配。注意，如果TLS握手框架被分割成多个TCP段（包），匹配器将无法匹配主机名。请看 [关于这个值的视频](https://youtu.be/T2CQyN-D4u4)。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **ttl** (_integer: 0..255_; Default: )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 匹配数据包的TTL值。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |

## 统计信息

显示额外的 _只读_ 属性:

```shell
/ip firewall filter print stats
[admin@MikroTik] > ip firewall filter print stats 
Flags : X - disabled, I - invalid, D - dynamic
 0  D ;;; special dummy rule to show fasttrack counters
      forward                                                                                                               passthrough              50 507 925 242      50 048 246
 1    ;;; defconf : drop invalid
      forward                                                                                                               drop                            432 270           9 719
 2    ;;; defconf : drop invalid
      input                                                                                                                 drop                            125 943           2 434
 3    input                                                                                                                 accept                   20 090 211 549      20 009 864
 4    ;;; defconf : accept ICMP
      input                                                                                                                 accept                          634 926           7 648
 5    ;;; defconf : drop all not coming from LAN
      input                                                                                                                 drop                          4 288 079          83 428
 6    ;;; defconf : accept in ipsec policy
      forward                                                                                                               accept                                0               0
7    ;;; defconf : accept out ipsec policy
      forward                                                                                                               accept                                0               0
8    ;;; defconf : fasttrack
      forward                                                                                                               fasttrack-connection     28 505 528 775      31 504 682
9    ;;; defconf : accept established,related, untracked
      forward                                                                                                               accept                   28 505 528 775      31 504 682
10    ;;; defconf : drop all from WAN not DSTNATed
      forward                                                                                                               drop                                  0               0
```

## IPv6

## 属性

| 属性                                                                                                                                                                                                                                                | 说明                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **action** (_accept \| add-dst-to-address-list \| ..._; Default: **accept**)                                                                                                                                                                        | 如果数据包被规则匹配，要采取的动作。<br>- accept - 接受数据包。它不会传递到下一个防火墙规则。<br>- add-dst-to-address-list - 将目标地址添加到由 `address-list` 参数指定的 [地址列表](https://wiki.mikrotik.com/index.php?title=Manual:IPv6/Firewall/Address_list&action=edit&redlink=1 "Manual:IPv6/Firewall/Address list (page does not exist)")<br>- add-src-to-address-list - 将源地址添加到由 `address-list` 参数指定的 [地址列表](https://wiki.mikrotik.com/index.php?title=Manual:IPv6/Firewall/Address_list&action=edit&redlink=1 "Manual:IPv6/Firewall/Address list (page does not exist)" )<br>- drop -丢弃数据包。<br>- jump - 跳到由 `jump-target` 参数值指定的用户定义链上<br>- log - 在系统日志中添加一条信息，包含以下信息：in-interface, out-interface, src-mac, protocol, src-ip:port->dst-ip:port and length of the packet. 数据包匹配后，传递到列表中的下一个规则，类似 `passthrough`。<br>- passthrough - 忽略这个规则，转到下一个规则（对统计有用）。<br>- reject - 丢弃数据包并发送一个ICMP拒绝信息<br>- return - 将控制权传回发生跳转的链上。 |
| **address-list-timeout** (_none-dynamic \| none-static \| time_; Default: **none-dynamic**)                                                                                                                                                         | 地址从 `address-list` 参数指定的地址列表中删除的时间间隔。与 `add-dst-to-address-list` 或 `add-src-to-address-list` 动作一起使用。<br>- 非动态值(`00:00:00`)将在地址列表中保留该地址，直到重新启动。<br>- 非静态的值将使地址永远留在地址列表中，并包括在配置导出/备份中。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **chain** (_name_; Default: )                                                                                                                                                                                                                       | 指定添加到哪个链的规则。如果输入的内容和已定义的链名称不一致，将创建一个新的链。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **comment** (_string_; Default: )                                                                                                                                                                                                                   | 规则的描述说明。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **chain** (_name_; Default: )                                                                                                                                                                                                                       | 指定添加到哪个链的规则。如果输入的内容和已定义的链名称不一致，将创建一个新的链。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **comment** (_string_; Default: )                                                                                                                                                                                                                   | 规则的描述说明。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **connection-bytes** (_integer-integer_; Default: )                                                                                                                                                                                                 | 只有通过特定连接传输了一定数量的字节时才会匹配数据包。0 - 表示无穷大，例如 `connection-bytes=2000000-0` 表示通过相关连接的传输量超过2MB，该规则就会匹配。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **connection-limit** (_integer,netmask_; Default: )                                                                                                                                                                                                 | 达到给定值后，匹配每个地址或地址块的连接。应该和connection-state=new或tcp-flags=syn一起使用，因为匹配器非常耗费资源。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **connection-mark** (_no-mark \| string_; Default: )                                                                                                                                                                                                | 匹配通过mangle设施标记的有特定连接标记的数据包。如果设置了 **无标记**，该规则将匹配所有未标记的连接。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **connection-rate** (_Integer 0...4294967295_; Default: )                                                                                                                                                                                           | 连接速率是一个防火墙匹配器，允许根据目前的连接速度来捕获流量。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **connection-state** (_established \| invalid \| new \| related \| untracked_; Default: )                                                                                                                                                           | 解释特定数据包的连接跟踪分析数据。<br>- established - 属于现有连接的数据包<br>- invalid - 在连接跟踪中没有确定状态的数据包（通常为 严重失序的数据包，序列号/ack号错误的数据包，或者在路由器上资源过度使用），由于这个原因，无效的数据包不会参与NAT（只有connection-state=new数据包），并且在路由时仍然包含原始源IP地址。建议在防火墙过滤器转发和输入链中丢弃所有 _connection-state=invalid_ 的数据包。<br>- new - 数据包开始了一个新的连接，或者和一个没有在两个方向上看到数据包的连接相关。<br>- related - 与现有连接相关的数据包，但不是现有连接的一部分，如ICMP错误或开始FTP数据连接的数据包<br>- untracked - 在防火墙 [RAW](https://wiki.mikrotik.com/wiki/Manual:IP/Firewall/Raw "Manual:IP/Firewall/Raw") 表中设置为绕过连接跟踪的数据包。                                                                                                                                                                                                                                                                                                                    |
| **connection-type** (_ftp \| h323 \| irc \| pptp \| quake3 \| sip \| tftp_; Default: )                                                                                                                                                              | 根据连接跟踪助手的信息，匹配来自相关连接的数据包。相关的连接帮助器必须在以下选项中启用。/ip firewall service-port                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **content** (_string_; Default: )                                                                                                                                                                                                                   | 匹配包含指定文本的数据包。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **dscp** (_integer: 0..63_; Default: )                                                                                                                                                                                                              | 匹配DSCP IP头。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **dst-address** (_IP/netmask \| IP range_; Default: )                                                                                                                                                                                               | 匹配目的地等于指定IP或属于指定IP范围的数据包。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **dst-address-list** (_name_; Default: )                                                                                                                                                                                                            | 根据用户定义的地址列表匹配数据包的目的地址。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **dst-address-type** (_unicast \| local \| broadcast \| multicast_; Default: )                                                                                                                                                                      | 匹配目的地址类型：<br>- unicast - 用于点对点传输的IP地址<br>- local - 如果dst-address分配给路由器的一个接口<br>- broadcast - 数据包发送到子网的所有设备上<br>- multicast - 数据包转发到一个定义的设备组中                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **dst-limit** (_integer[/time],integer,dst-address \| dst-port \| src-address[/time]_; Default: )                                                                                                                                                   | 匹配数据包，直到超过给定的速率。速率被定义为每个时间间隔的数据包。与极限匹配器相反，每个流都有自己的极限。流量由一个模式参数定义。参数以下列格式书写。`rate[/time],burst,mode[/expire]`.<br>- **rate** - 匹配每个流的时间间隔的数据包计数<br>- **time** - 指定每个流量的数据包计数率不能超过的时间间隔（可选，如果不指定将使用1s）。<br>- **burst** - 每个流量匹配的数据包的初始数量：这个数字每隔 `time`/`rate` 就会增加一个，最多到这个数字。<br>- **mode** - 参数指定了定义流量的特殊字段（src-address, dst-address, src-and-dst-address, dst-address-and-port, addresses-and-dst-port)<br>- **expire** - 指定没有数据包的流量允许删除的时间间隔（可选）。                                                                                                                                                                                                                                                                                                                                                                                                       |
| **dst-port** (_integer[-integer]: 0...65535_; Default: )                                                                                                                                                                                            | 目标端口号或端口号范围列表                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **icmp-options** (_integer:integer_; Default: )                                                                                                                                                                                                     | 匹配ICMP类型：代码字段                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **in-bridge-port** (_name_; Default: )                                                                                                                                                                                                              | 如果传入的接口是网桥，则为数据包进入路由器的实际接口。只有在桥接设置中启用了 **use-ip-firewall** 时才起作用。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **in-bridge-port-list** (_name_; Default: )                                                                                                                                                                                                         | 在接口列表中定义的一组接口。作用与in-bridge-port 相同。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **in-interface** (_name_; Default: )                                                                                                                                                                                                                | 数据包进入路由器的接口。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **in-interface-list** (_name_; Default: )                                                                                                                                                                                                           | 在接口列表中定义的一组接口。与in-interface的作用相同。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **ingress-priority** (_integer: 0..63_; Default: )                                                                                                                                                                                                  | 匹配入站数据包的优先级。优先级可以从VLAN、WMM、DSCP或MPLS EXP位中得到。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **ipsec-policy** (_in \| out, ipsec \| none_; Default: )                                                                                                                                                                                            | 匹配IPsec的策略。值按下列格式书写。**方向，策略**。方向用来选择是否匹配用于解封装或封装策略。<br>- in - 在PREROUTING、INPUT和FORWARD链中有效<br>- out - 在POSTROUTING、OUTPUT和FORWARD链中有效<br>- ipsec - 匹配数据包是否接受IPsec处理<br>- none - 匹配不受IPsec处理的数据包（例如，IPSec传输数据包）<br>例如，如果路由器收到一个IPsec封装的Gre包，那么规则 `ipsec-policy=in,ipsec` 将匹配Gre包，但规则 `ipsec-policy=in,none` 将匹配ESP包。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **jump-target** (_name_; Default: )                                                                                                                                                                                                                 | 要跳到的目标链名称。仅在 `action=jump` 时有用。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **limit** (_integer,time,integer_; Default: )                                                                                                                                                                                                       | 匹配数据包到一个有限的速率（数据包速率或比特率）。使用该匹配器的规则进行匹配，直到达到该限制。参数按下列格式写入。`rate[/time],burst:mode`:<br>- **rate** - 匹配每一时间间隔的数据包或比特数                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | <br>- **time** - 指定不超过数据包或比特率的时间间隔（可选，如果不指定将使用1s） | <br>- **burst** - 匹配的数据包或比特的初始数量：这个数字每10ms就会被填充，所以burst应该至少是每秒速率的1/100<br>- **mode** - 数据包或比特模式 |
| **log** (_yes \| no; Default:_ **no**)                                                                                                                                                                                                              | 在系统日志中添加一条信息，包含以下信息：in-interface, out-interface, src-mac, protocol, src-ip:port->dst-ip:port, 和包的长度。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **log-prefix** (_string_; Default: )                                                                                                                                                                                                                | 在每条日志信息的开头添加指定的文本。如果配置了 _action=log_ 或 _log=yes_ 则可用。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **nth** (_integer,integer_; Default: )                                                                                                                                                                                                              | 匹配每n个数据包。_nth=2,1_规则将匹配每两个包的第一个数据包，因此，50%的流量会被匹配。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **out-bridge-port** (_name_; Default: )                                                                                                                                                                                                             | 如果出站接口是网桥，则为数据包离开路由器的实际接口。只有在桥接设置中启用了 **use-ip-firewall** 的情况下才起作用。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **out-bridge-port-list** (_name_; Default: )                                                                                                                                                                                                        | 在接口列表中定义的一组接口。与out-bridge-port的作用相同。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **out-interface** (; Default: )                                                                                                                                                                                                                     | 数据包离开路由器的接口。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **out-interface-list** (_name_; Default: )                                                                                                                                                                                                          | 在接口列表中定义的一组接口。与out-interface的作用相同。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **packet-mark** (_no-mark \| string_; Default: )                                                                                                                                                                                                    | 匹配通过纠错工具标记的、带有特定包标记的数据包。如果设置了 **无标记**，该规则将匹配所有无标记的数据包。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **packet-size** (_integer[-integer]:0...65535_; Default: )                                                                                                                                                                                          | 匹配指定大小或大小范围字节的数据包。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **per-connection-classifier** (_ValuesToHash:Denominator/Remainder_; Default: )                                                                                                                                                                     | PCC匹配器允许将流量分为相等的流，并能够把有特定选项集的数据包保留在一个特定的流中。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **port** (_integer[-integer]: 0...65535_; Default: )                                                                                                                                                                                                | 如果任何（源或目的）端口与指定的端口或端口范围列表匹配，则进行匹配。仅当 "协议 "为TCP或UDP时适用。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **priority** (_integer: 0..63_; Default:)                                                                                                                                                                                                           | 在设置新的优先级后，匹配数据包的优先级。优先级可以来自VLAN、WMM、DSCP、MPLS EXP位，或者来自使用set-priority设置的优先级。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **protocol** (_name or protocol ID_; Default: **tcp**)                                                                                                                                                                                              | 匹配由协议名称或数字指定的特定IP协议。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **random** (_integer: 1..99_; Default: )                                                                                                                                                                                                            | 以一定的概率随机匹配数据包。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **reject-with** (_icmp-admin-prohibited \| icmp-net-prohibited \| icmp-protocol-unreachable \| icmp-host-prohibited \| icmp-network-unreachable \| tcp-reset \| icmp-host-unreachable \| icmp-port-unreachable_; Default: icmp-network-unreachable) | 指定如果数据包被拒绝将发送的ICMP错误。如果 `action=reject` 则可用。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **routing-mark** (_string_; Default: )                                                                                                                                                                                                              | 匹配由mangle设施标记的带有特定路由标记的数据包。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **src-address** (_Ip/Netmask, Ip range_; Default: )                                                                                                                                                                                                 | 匹配来源等于指定IP或指定IP范围的数据包。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **src-address-list** (_name_; Default: )                                                                                                                                                                                                            | 根据用户定义的地址列表匹配数据包的源地址。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **src-address-type** (_unicast \| local \| broadcast \| multicast_; Default: )                                                                                                                                                                      | {ta{tableMatches源地址类型。<br>- unicast - 用于点对点传输的IP地址<br>- local - 如果一个地址分配给路由器的一个接口<br>- broadcast - 数据包发送到子网的所有设备上<br>- multicast - 数据包转发到一个定义的设备组中                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **src-port** (_integer[-integer]: 0...65535_; Default: )                                                                                                                                                                                            | 源端口和源端口范围列表。只有当协议是TCP或UDP时才适用。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **src-mac-address** (_MAC address_; Default: )                                                                                                                                                                                                      | 匹配数据包的源MAC地址。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **tcp-flags** (_ack \| cwr \| ece \| fin \| psh \| rst \| syn \| urg_; Default: )                                                                                                                                                                   | 匹配指定的TCP标志<br>- ack - 确认数据<br>- cwr - 拥塞窗口减少<br>- ece - ECN-echo标志（明确的拥塞通知）。<br>- fin - 关闭连接<br>- psh - 推送功能<br>- rst - 撤销连接<br>- syn - 新连接<br>- urg - 紧急数据                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **tcp-mss** (_integer[-integer]: 0...65535_; Default: )                                                                                                                                                                                             | 匹配IP包的TCP MSS值。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **time** (_time-time,sat \| fri \| thu \| wed \| tue \| mon \| sun_; Default: )                                                                                                                                                                     | 允许根据数据包的到达时间和日期创建过滤器，对于本地生成的数据包，则是离开时间和日期。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **tls-host** (_string_; Default: )                                                                                                                                                                                                                  | 允许根据TLS SNI主机名来匹配HTTPS流量。接受 [GLOB语法](https://en.wikipedia.org/wiki/Glob_(programming)) 的通配符。注意，如果TLS握手帧被分割成多个TCP段（数据包），匹配器将无法匹配主机名。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |

## 统计信息

`/ipv6/firewall/filter/print/stats`

显示额外的 _只读_ 属性:

| 属性                    | 说明                  |
| ----------------------- | --------------------- |
| **bytes** (_integer_)   | 规则匹配的字节总数 数 |
| **packets** (_integer_) | 规则匹配的数据包总数  |

## 示例

关于如何正确保护你的设备的例子，可以在 [建立第一个防火墙](https://help.mikrotik.com/docs/display/ROS/Building+Your+First+Firewall) 中找到!
